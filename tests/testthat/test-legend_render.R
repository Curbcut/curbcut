test_that("legend_breaks.q5 (without `chr_breaks` attribute) works", {
  vars <- vars_build(
    var_left = "housing_tenant_2016",
    var_right = " ", df = "CMA_DA"
  )
  p <- legend_render(vars, font_family = NULL)
  expect_error(print(p), NA)
})

test_that("legend_breaks.q5 (with `chr_breaks` attribute) works", {
  vars <- vars_build(
    var_left = "climate_drought_2016",
    var_right = " ", df = "grid_grid"
  )
  p <- legend_render(vars, font_family = NULL)
  expect_error(print(p), NA)
})

# test_that("legend_render.qual works", {
#   vars <- vars_build(var_left = "",
#                      var_right = " ", df = "")
#   p <- legend_render(vars)
#   expect_error(print(p), NA)
# })

test_that("legend_render.bivar  works", {
  vars <- vars_build(
    var_left = "housing_tenant_2016",
    var_right = "inc_limat_2016", df = "CMA_CSD"
  )
  p <- legend_render(vars, font_family = NULL)
  expect_error(print(p), NA)
})

test_that("legend_render.delta  works", {
  vars <- vars_build(
    var_left = c("housing_tenant_2006", "housing_tenant_2016"),
    var_right = " ", df = "CMA_CSD"
  )
  p <- legend_render(vars, font_family = NULL)
  expect_error(print(p), NA)
})

test_that("legend_render.q100  works", {
  vars <- vars_build(
    var_left = "c_flood",
    var_right = " ", df = "raster"
  )
  p <- legend_render(vars, font_family = NULL)
  expect_error(print(p), NA)
})

test_that("legend_render.delta_bivar  works", {
  vars <- vars_build(
    var_left = c("housing_tenant_2006", "housing_tenant_2016"),
    var_right = c("inc_50_2006", "inc_50_2016"), df = "city_CSD"
  )
  data <- data_get(vars)
  p <- legend_render(vars, data = data)
  expect_error(print(p), NA)
})

test_that("legend_render.bivar_ldelta_rq3  works", {
  vars <- vars_build(
    var_left = c("housing_tenant_2006", "housing_tenant_2016"),
    var_right = "inc_limat_2016", df = "city_CSD"
  )
  data <- data_get(vars)
  p <- legend_render(vars, data = data)
  expect_error(print(p), NA)
})
